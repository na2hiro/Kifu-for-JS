<html lang="ja">
<head>
<title>Kifu for JS example</title>
<meta charset="utf-8">
<script src="../bundle/kifu-for-js-legacy.min.js" charset="utf-8"></script>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script>KifuForJS.load("./files/ki2/9fu.ki2", "ki2dom");</script>
	<style>
		#hachimai + ins svg {
			border: 1px black solid;
		}
	</style>
</head>

<body>
<h1>Kifu for JS 動作例</h1>
JavaもFlashも使わない，JavaScriptだけで動く<a href="https://github.com/na2hiro/Kifu-for-JS/tree/master/packages/Kifu-for-JS#readme">Kifu for JS</a>の動作例です．

<h2>注意</h2>
こちらは動作確認用のページです。使い方などについては<a href="https://kifu-for-js.81.la">ドキュメンテーション</a>を参照してください。

<h2>目次</h2>
<ul>
	<li><a href="#example">例</a>
		<ul>
			<li><a href="#kif">KIFファイル読み込み</a></li>
			<li><a href="#ki2">KI2ファイル読み込み (DOM id 指定)</a></li>
			<li><a href="#csa">CSAファイル読み込み</a></li>
			<li><a href="#jkf">JKFファイル読み込み</a></li>
			<li><a href="#text">テキスト読み込み＆JSからのテキスト再読み込み</a></li>
		</ul>
	</li>
	<li><a href="#example-mobx">mobxによる状態監視の例</a>
		<ul>
			<li><a href="#mobx-tesuu">手数変化を受け取る</a></li>
		</ul>
	</li>
</ul>

<h2><a id="example">例</a></h2>

<h3>各種読み込み方式</h3>
<h4>棋譜埋め込み方式</h4>
<script type="text/kifu">
	# KIF形式棋譜ファイル
	# Generated by Shogidokoro
	後手の持駒：飛　金三　銀三　桂二　香四　歩十三
	  ９ ８ ７ ６ ５ ４ ３ ２ １
	+---------------------------+
	| ・ ・ ・ ・ 馬 ・ ・v桂 ・|一
	| ・ ・ ・ ・ ・ ・ ・v玉 ・|二
	| ・ ・ ・ ・ ・ ・v歩v歩 ・|三
	| ・ ・ ・ ・ ・ ・ ・v金v歩|四
	| ・ ・ ・ ・ 歩 ・ ・ ・ 歩|五
	| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
	| ・ ・ ・ ・ ・ ・ ・ ・ ・|七
	| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
	| ・ ・ ・ ・ ・ ・ ・ ・ ・|九
	+---------------------------+
	先手の持駒：飛　角　銀　桂
	先手：
	後手：
	手数----指手---------消費時間--
	   1 ５二飛打      (00:31 / 00:00:31)
	   2 ３二金打      (00:00 / 00:00:00)
	   3 ３一角打      (00:00 / 00:00:31)
	   4 同　玉(22)    (00:00 / 00:00:00)
</script>

<h4>外部ファイル方式</h4>
<script type="text/kifu" data-src="./files/kif/jt201409130101.kif"></script>

<h4>Kifu for Java/Flashの自動解釈</h4>
TODO

<h4><a id="kiflite">JavaScript関数による動的読み込み (lite)</a></h4>
<div id="kiflite-container" style="max-width: 600px;"></div>
<script>var kifuLite = KifuForJS.load("./files/kif/jt201409130101.kif","kiflite-container", {mode: "latest"});</script>

<h4><a id="kif">JavaScript関数による動的読み込み (legacy)</a></h4>
<div id="kif-container" style="max-width: 600px;"></div>
<script>var kifu = KifuForJS.load("./files/kif/jt201409130101.kif","kiflite-container");</script>

<h3>色々な棋譜</h3>
<h4>分岐棋譜</h4>
<script type="text/kifu" data-src="./files/kif/fork.kif"></script>

<h4>KI2形式</h4>
<div id="ki2dom"></div>

<h3><a id="csa">CSA形式</a></h3>
<script type="text/kifu" data-src="./files/csa/8mai.csa"></script>

<h3><a id="jkf">JKF形式</a></h3>
<script type="text/kifu" data-src="./files/jkf/ryuou201409020101.jkf"></script>

<h3>各種設定</h3>
<h4>X手目から</h4>
<script type="text/kifu" data-src="./files/csa/8mai.csa" data-ply="10" id="hachimai"></script>
<h4>分岐局面から</h4>
<script type="text/kifu" data-src="./files/kif/fork.kif" data-ply="3" data-forkPointers="[[1, 0]]"></script>

<h4>図面モード</h4>
<script type="text/kifu" data-ply="3" data-forkPointers="[[1, 0]]" data-static>
#KIF version=2.0 encoding=Shift_JIS
# ---- Kifu for Windows V7 V7.08 棋譜ファイル ----
開始日時：2014/10/16 03:21:41
終了日時：2014/10/18 18:46:58
手合割：平手　　
先手：
後手：
手数----指手---------消費時間--
   1 ７六歩(77)   ( 0:02/00:00:02)+
   2 ３四歩(33)   ( 0:01/00:00:01)+
   3 ２六歩(27)   ( 0:01/00:00:03)+
   4 投了         ( 0:00/00:00:01)
まで3手で先手の勝ち

変化：3手
   3 ７五歩(76)   ( 0:01/00:00:03)
   4 中断         ( 0:00/00:00:01)
まで3手で中断

変化：2手
   2 ８四歩(83)   ( 0:07/00:00:07)
   3 ６八銀(79)   ( 0:02/00:00:04)+
   4 持将棋       ( 0:00/00:00:07)
まで3手で持将棋

変化：3手
   3 ２六歩(27)   ( 0:08/00:00:10)
   4 切れ負け     ( 0:00/00:00:07)
まで3手で時間切れにより先手の勝ち

変化：1手
   1 ２六歩(27)   ( 0:05/00:00:05)
   2 ３四歩(33)   ( 0:03/00:00:03)+
   3 ２五歩(26)   ( 0:01/00:00:06)+
   4 反則勝ち     ( 0:00/00:00:03)
まで3手で後手の反則勝ち

変化：3手
   3 ７六歩(77)   ( 0:04/00:00:09)
   4 千日手       ( 0:00/00:00:03)
まで3手で千日手

変化：2手
   2 ８四歩(83)   ( 0:01/00:00:01)
   3 ２五歩(26)   ( 0:01/00:00:06)+
   4 詰み         ( 0:00/00:00:01)
まで3手で詰

変化：3手
   3 ７六歩(77)   ( 0:02/00:00:07)
   4 不詰         ( 0:00/00:00:01)
まで3手で不詰
</script>

<h4>図面モード(SFEN)</h4>
<script type="text/kifu" data-static>
ln1gkg1nl/6+P2/2sppps1p/2p3p2/p8/P1P1P3P/2NP1PP2/3s1KSR1/L1+b2G1NL w R2Pbgp 42
</script>

<h4>図面モード(BOD)</h4>
<script type="text/kifu" data-static>
後手の持駒：飛　金三　銀三　桂二　香四　歩十三
  ９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
| ・ ・ ・ ・ 馬 ・ ・v桂 ・|一
| ・ ・ ・ ・ ・ ・ ・v玉 ・|二
| ・ ・ ・ ・ ・ ・v歩v歩 ・|三
| ・ ・ ・ ・ ・ ・ ・v金v歩|四
| ・ ・ ・ ・ 歩 ・ ・ ・ 歩|五
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
| ・ ・ ・ ・ ・ ・ ・ ・ ・|七
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
| ・ ・ ・ ・ ・ ・ ・ ・ ・|九
+---------------------------+
先手の持駒：飛　角　銀　桂
先手：
後手：
</script>

<h4>図面モード、着手表示抑制</h4>
<script type="text/kifu" data-src="./files/csa/8mai.csa" data-ply="10" data-static data-static-last="hidden"></script>

<h4>図面モード、着手表示指定</h4>
<script type="text/kifu" data-static data-static-last="[3, 2]">
ln1gkg1nl/6+P2/2sppps1p/2p3p2/p8/P1P1P3P/2NP1PP2/3s1KSR1/L1+b2G1NL w R2Pbgp 42
</script>

<h3><a id="text">テキスト読み込み＆JSからのテキスト再読み込み</a></h3>
<script>var kifu = KifuForJS.loadString("▲７六歩  △８四歩  ▲６八銀");</script>
<textarea id="kifuString" aria-label="棋譜">
  ▲７六歩  △８四歩  ▲６八銀
</textarea>
<button onclick="kifu.then(kifuStore => kifuStore.loadKifu(document.getElementById('kifuString').value))">読み込み</button>
</body>

<h2><a id="example-mobx">mobxによる状態監視の例</a></h2>
<h3><a id="mobx-tesuu">手数変化を受け取る</a></h3>
<div>現在<span id="tesuu" style="font-size: large"></span>手目です!
	<button onclick="myKifuStore.player.goto(Math.floor(Math.random()*100))">適当な局面にジャンプ</button>
</div>
<script>
KifuForJS.load("./files/kif/jt201409130101.kif").then((kifuStore) => {
	window.myKifuStore = kifuStore;
	KifuForJS.mobx.autorun(()=>{
		document.getElementById("tesuu").textContent = kifuStore.player.tesuu;
	})
});
</script>
</body>
</html>
