import TOCInline from '@theme/TOCInline';

# 棋譜の読み込み方式

棋譜の読み込みには次のような方式があります。

<TOCInline toc={toc} />

## 棋譜埋め込み方式

棋譜を直接マークアップする方式です。ブログなどに便利です。

```html
<script type="text/kifu">
# KIF形式棋譜ファイル
# Generated by Shogidokoro
後手の持駒：飛　金三　銀三　桂二　香四　歩十三
  ９ ８ ７ ６ ５ ４ ３ ２ １
+---------------------------+
| ・ ・ ・ ・ 馬 ・ ・v桂 ・|一
| ・ ・ ・ ・ ・ ・ ・v玉 ・|二
| ・ ・ ・ ・ ・ ・v歩v歩 ・|三
| ・ ・ ・ ・ ・ ・ ・v金v歩|四
| ・ ・ ・ ・ 歩 ・ ・ ・ 歩|五
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六
| ・ ・ ・ ・ ・ ・ ・ ・ ・|七
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八
| ・ ・ ・ ・ ・ ・ ・ ・ ・|九
+---------------------------+
先手の持駒：飛　角　銀　桂
先手：
後手：
手数----指手---------消費時間--
   1 ５二飛打      (00:31 / 00:00:31)
   2 ３二金打      (00:00 / 00:00:00)
   3 ３一角打      (00:00 / 00:00:31)
   4 同　玉(22)    (00:00 / 00:00:00)
</script>
```

:::note
このドキュメンテーション内で使用されている例では、この方式を取っています。
:::

## 外部ファイル方式

`.kif` などの棋譜ファイルを読み込む方式です。

```html
<script type="text-kifu" data-src="./great-tsume.kif"></script>
```

:::caution
**ブラウザによるセキュリティ上の制約**
* 通常、同一ドメイン上の棋譜しか読み込めません。
* ローカルのファイルシステム上にあるファイルの読み込みはできません。[ローカルでサーバを立てる](https://qiita.com/sudahiroshi/items/e74d61d939f18779970d)か、実際のサーバ上にアップロードして確認してください。
:::

## Kifu for Java/Flashの自動解釈

Kifu for Java (2015年頃対応終了)やKifu for Flash (2020年頃対応終了)が設置されたページの棋譜を自動解釈する方式です。

```html
<script>
  KifuForJS.recover()
</script>
```

## JavaScript関数による動的読み込み

JavaScriptを直接書いて局面を動的に読み込む場合のために、関数 `load()` を用意しています。

第二引数は、通常`data-x-y="z"`などと指定するものを`{"x": {"y": "z"}}`とオブジェクト化したものを指定します。

```html
<script src="kifu-for-js.js"></script>
<div id="container"></div>

<script>
  button.addEventListener("click", function() {
    KifuForJS.load("container", {
      kifu: "▲７六歩　△３四歩…",
      static: true,
      ply: 12
    });
  });
</script>
```

* `kifu` は棋譜を指定します。
* `data-static`などの値がないattributeの場合は、`true`の値を指定します。
